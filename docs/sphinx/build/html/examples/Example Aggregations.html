
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Aggregating data with MDF &#8212; mdf-forge 0.5.1 documentation</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Example Analysis" href="Example Analysis - Fe-Cr-Al Oxidation.html" />
    <link rel="prev" title="Requirements" href="requirements.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Example Analysis - Fe-Cr-Al Oxidation.html" title="Example Analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="requirements.html" title="Requirements"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">mdf-forge 0.5.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../examples.html" accesskey="U">Examples</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Aggregating data with MDF</a><ul>
<li><a class="reference internal" href="#aggregate_source---NIST-XPS-DB">aggregate_source - NIST XPS DB</a></li>
<li><a class="reference internal" href="#aggregate---Multiple-Datasets">aggregate - Multiple Datasets</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="requirements.html"
                        title="previous chapter">Requirements</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Example Analysis - Fe-Cr-Al Oxidation.html"
                        title="next chapter">Example Analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/examples/Example Aggregations.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 9ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<div class="section" id="Aggregating-data-with-MDF">
<h1>Aggregating data with MDF<a class="headerlink" href="#Aggregating-data-with-MDF" title="Permalink to this headline">¶</a></h1>
<p>Searches using <code class="docutils literal notranslate"><span class="pre">Forge.search()</span></code> are limited to 10,000 results.
However, there are two methods to circumvent this restriction:
<code class="docutils literal notranslate"><span class="pre">Forge.aggregate_source()</span></code> and <code class="docutils literal notranslate"><span class="pre">Forge.aggregate()</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">mdf_forge.forge</span> <span class="kn">import</span> <span class="n">Forge</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">mdf</span> <span class="o">=</span> <span class="n">Forge</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="aggregate_source---NIST-XPS-DB">
<h2>aggregate_source - NIST XPS DB<a class="headerlink" href="#aggregate_source---NIST-XPS-DB" title="Permalink to this headline">¶</a></h2>
<p>Example: We want to collect all records from the NIST XPS Database and
analyze the quality metrics. This database has almost 30,000 records, so
we have to use <code class="docutils literal notranslate"><span class="pre">aggregate()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># First, let&#39;s aggregate all the nist_xps_db data.</span>
<span class="n">all_entries</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">aggregate_source</span><span class="p">(</span><span class="s2">&quot;nist_xps_db&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_entries</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
100%|██████████| 29189/29189 [00:27&lt;00:00, 1067.83it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
29189
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Now, let&#39;s parse out the &quot;Quality of Data&quot; and print te results for analysis.</span>
<span class="n">qualities</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">all_entries</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">record</span><span class="p">[</span><span class="s2">&quot;mdf&quot;</span><span class="p">][</span><span class="s2">&quot;resource_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;record&quot;</span><span class="p">:</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">record</span><span class="p">[</span><span class="s2">&quot;mdf&quot;</span><span class="p">][</span><span class="s2">&quot;raw&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">raw</span><span class="p">[</span><span class="s2">&quot;Quality of Data&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">qualities</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">qualities</span><span class="p">[</span><span class="n">raw</span><span class="p">[</span><span class="s2">&quot;Quality of Data&quot;</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">qualities</span><span class="p">[</span><span class="n">raw</span><span class="p">[</span><span class="s2">&quot;Quality of Data&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">print</span><span class="p">(</span><span class="n">qualities</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;&#39;: 15940, &#39;good&#39;: 4, &#39;Good&#39;: 1615, &#39;Adequate&#39;: 11630}
</pre></div></div>
</div>
</div>
<div class="section" id="aggregate---Multiple-Datasets">
<h2>aggregate - Multiple Datasets<a class="headerlink" href="#aggregate---Multiple-Datasets" title="Permalink to this headline">¶</a></h2>
<p>Example: We want to analyze how often elements are studied with Gallium
(Ga), and what the most frequent elemental pairing is. There are more
than 10,000 records containing Gallium data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># First, let&#39;s aggregate everything that has &quot;Ga&quot; in the list of elements.</span>
<span class="n">all_results</span> <span class="o">=</span> <span class="n">mdf</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="s2">&quot;mdf.elements:Ga&quot;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_results</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
100%|██████████| 29168/29168 [01:07&lt;00:00, 298.34it/s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
29168
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Now, let&#39;s parse out the other elements in each record and keep a running tally to print out.</span>
<span class="n">elements</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">all_results</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">record</span><span class="p">[</span><span class="s2">&quot;mdf&quot;</span><span class="p">][</span><span class="s2">&quot;resource_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;record&quot;</span><span class="p">:</span>
        <span class="n">elems</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s2">&quot;mdf&quot;</span><span class="p">][</span><span class="s2">&quot;elements&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elems</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elements</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">elements</span><span class="p">[</span><span class="n">elem</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">elements</span><span class="p">[</span><span class="n">elem</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;: &#39;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{
    &#34;Ac&#34;: 651,
    &#34;Ag&#34;: 588,
    &#34;Al&#34;: 576,
    &#34;Ar&#34;: 2,
    &#34;As&#34;: 1330,
    &#34;Au&#34;: 649,
    &#34;B&#34;: 681,
    &#34;Ba&#34;: 802,
    &#34;Be&#34;: 496,
    &#34;Bi&#34;: 583,
    &#34;Br&#34;: 127,
    &#34;C&#34;: 1843,
    &#34;Ca&#34;: 682,
    &#34;Cd&#34;: 581,
    &#34;Ce&#34;: 639,
    &#34;Cl&#34;: 672,
    &#34;Co&#34;: 954,
    &#34;Cr&#34;: 712,
    &#34;Cs&#34;: 552,
    &#34;Cu&#34;: 817,
    &#34;Dy&#34;: 600,
    &#34;Er&#34;: 670,
    &#34;Eu&#34;: 614,
    &#34;F&#34;: 344,
    &#34;Fe&#34;: 793,
    &#34;Ga&#34;: 29168,
    &#34;Gd&#34;: 612,
    &#34;Ge&#34;: 776,
    &#34;H&#34;: 1933,
    &#34;Hf&#34;: 659,
    &#34;Hg&#34;: 534,
    &#34;Ho&#34;: 598,
    &#34;I&#34;: 187,
    &#34;In&#34;: 603,
    &#34;Ir&#34;: 557,
    &#34;K&#34;: 698,
    &#34;La&#34;: 960,
    &#34;Li&#34;: 990,
    &#34;Lu&#34;: 527,
    &#34;Mg&#34;: 955,
    &#34;Mn&#34;: 715,
    &#34;Mo&#34;: 606,
    &#34;N&#34;: 1402,
    &#34;Na&#34;: 840,
    &#34;Nb&#34;: 564,
    &#34;Nd&#34;: 616,
    &#34;Ni&#34;: 836,
    &#34;Np&#34;: 506,
    &#34;O&#34;: 4031,
    &#34;Os&#34;: 668,
    &#34;P&#34;: 676,
    &#34;Pa&#34;: 607,
    &#34;Pb&#34;: 544,
    &#34;Pd&#34;: 653,
    &#34;Pm&#34;: 624,
    &#34;Pr&#34;: 714,
    &#34;Pt&#34;: 743,
    &#34;Pu&#34;: 535,
    &#34;Rb&#34;: 588,
    &#34;Re&#34;: 498,
    &#34;Rh&#34;: 584,
    &#34;Ru&#34;: 562,
    &#34;S&#34;: 512,
    &#34;Sb&#34;: 632,
    &#34;Sc&#34;: 715,
    &#34;Se&#34;: 374,
    &#34;Si&#34;: 1075,
    &#34;Sm&#34;: 773,
    &#34;Sn&#34;: 606,
    &#34;Sr&#34;: 711,
    &#34;Ta&#34;: 558,
    &#34;Tb&#34;: 591,
    &#34;Tc&#34;: 508,
    &#34;Te&#34;: 758,
    &#34;Th&#34;: 519,
    &#34;Ti&#34;: 693,
    &#34;Tl&#34;: 687,
    &#34;Tm&#34;: 590,
    &#34;U&#34;: 507,
    &#34;V&#34;: 714,
    &#34;W&#34;: 563,
    &#34;Xe&#34;: 1,
    &#34;Y&#34;: 724,
    &#34;Yb&#34;: 741,
    &#34;Zn&#34;: 672,
    &#34;Zr&#34;: 648
}
</pre></div></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Example Analysis - Fe-Cr-Al Oxidation.html" title="Example Analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="requirements.html" title="Requirements"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">mdf-forge 0.5.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../examples.html" >Examples</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright Apache License, Version 2.0.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.0.
    </div>
  </body>
</html>